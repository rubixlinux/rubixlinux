# Maintainer: Joshua Rubin <joshua@rubixlinux.org>

pkgname=ipw2100
pkgver=1.2.1
pkgrel=1
pkgdesc="ipw2100 - support for the Intel PRO/Wireless 2100 Network Connection miniPCI adapters."
url="http://ipw2100.sourceforge.net"
install=$pkgname.install
source=(http://dl.sourceforge.net/sourceforge/$pkgname/$pkgname-$pkgver.tgz		\
	ipw2100-fw-1.3.tgz								)
depends=('ieee80211' 'wireless_tools')
md5sums=('9db50b836c63dc3a7e56653d2009717a' \
	 '46aa75bcda1a00efa841f9707bbbd113' )

vver26=2.6.15.5-Rubix

## Todo:
##   None

## Notes:
##   None

## Changelog:
##   rel1: upgraded to 1.2.1, built for 2.6.15.5 2006.03.03
##   rel4: rebuilt for 2.6.15.4 2006.02.12
##   rel3: rebuilt for 2.6.15.3 2006.02.07
##   rel2: rebuilt for 2.6.15.2 2006.01.31
##   rel1: upgraded to 1.1.4, built for 2.6.15.1 2006.01.20
##   rel4: rebuilt for 2.6.15 (rel2 and 3 were only used internally) 2006.01.10
##   rel1: rebuilt for kernel 2.6.14.2 2005.11.12
##   rel1: upgraded to 1.1.3 2005.10.28
##   rel1: initial rubix release

build() {

	cd $startdir/src/$pkgname-$pkgver

	make IEEE80211_INC=/usr/include KSRC=/usr/src/linux-$vver26 || return 1

	mkdir -p	$startdir/pkg/lib/modules/$vver26/kernel/drivers/net/wireless/$pkgname
	cp *.ko		$startdir/pkg/lib/modules/$vver26/kernel/drivers/net/wireless/$pkgname

	mkdir -p $startdir/pkg/usr/doc/$pkgname-$pkgver
	cp	-a		\
		CHANGES		\
		FILES		\
		GIT_SHA1	\
		INSTALL		\
		LICENSE		\
		README.ipw2100	\
	$startdir/pkg/usr/doc/$pkgname-$pkgver

	cd $startdir/src

	mkdir -p	$startdir/pkg/lib/firmware
	cp *.fw		$startdir/pkg/lib/firmware

	cp LICENSE $startdir/pkg/usr/doc/$pkgname-$pkgver/LICENSE-firmware

	chmod 644 $startdir/pkg/usr/doc/$pkgname-$pkgver/*

	find  $startdir/pkg/lib/modules -type f -name *.ko -exec gzip {} \;

}
